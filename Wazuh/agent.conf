<agent_config>
  <!-- File Integrity Monitoring -->
  <syscheck>
    <disabled>no</disabled>
    <frequency>43200</frequency>        <!-- 12h baseline scan -->
    <scan_on_start>yes</scan_on_start>
    <alert_new_files>yes</alert_new_files>

    <!-- Linux sensitive directories -->
    <directories realtime="yes">/root</directories>
    <directories realtime="yes">/tmp</directories>
    <directories realtime="yes">/var/tmp</directories>
    <directories realtime="yes">/home/*/Downloads</directories>

    <!-- Windows sensitive directories -->
    <directories realtime="yes">C:\Users\*\Downloads</directories>
    <directories realtime="yes">C:\Windows\Temp</directories>
    <directories realtime="yes">C:\Temp</directories>
    <directories realtime="yes">C:\Users\*\AppData\Local\Temp</directories>

    <!-- Ignore noisy files -->
    <ignore type="sregex">.log$|.swp$</ignore>
    <skip_nfs>yes</skip_nfs>
    <skip_dev>yes</skip_dev>
    <skip_proc>yes</skip_proc>
    <skip_sys>yes</skip_sys>
  </syscheck>

  <!-- Log Collection -->
  <!-- Linux SSH logins -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/log/auth.log</location>
  </localfile>

  <!-- Windows RDP logins -->
  <localfile>
    <log_format>eventchannel</log_format>
    <location>Security</location>
  </localfile>

  <!-- Journald (Linux systemd logs) -->
  <localfile>
    <log_format>journald</log_format>
    <location>journald</location>
  </localfile>

  <!-- Active responses log -->
  <localfile>
    <log_format>syslog</log_format>
    <location>/var/ossec/logs/active-responses.log</location>
  </localfile>
  
  <!-- Security Configuration Assessment -->
  <sca>
    <enabled>yes</enabled>
    <scan_on_start>yes</scan_on_start>
    <interval>12h</interval>
    <!-- No explicit <policies> block here: agent will auto-load
         any .yml policies present in /var/ossec/ruleset/sca/ that
         match its OS/service requirements -->
  </sca>

</agent_config>